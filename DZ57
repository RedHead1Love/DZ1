using System;
using System.Collections.Generic;
using System.Linq;

namespace MilitarySquads
{
    class Program
    {
        static void Main()
        {
            var squadManager = new SquadManager();
            squadManager.RunTransferProcess();
        }
    }

    public class Soldier
    {
        public Soldier(string lastName, string weapon)
        {
            LastName = lastName;
            Weapon = weapon;
        }

        public string LastName { get; }
        public string Weapon { get; }

        public override string ToString() => $"{LastName} ({Weapon})";
    }

    public class Squad
    {
        private List<Soldier> _soldiers;

        public Squad(IEnumerable<Soldier> soldiers)
        {
            _soldiers = soldiers.ToList();
        }

        public int Count => _soldiers.Count;

        public IEnumerable<Soldier> GetSoldiersOrdered() =>
            _soldiers.OrderBy(soldier => soldier.LastName);

        public List<Soldier> ExtractSoldiers(Func<Soldier, bool> predicate)
        {
            var extracted = _soldiers.Where(predicate).ToList();
            _soldiers = _soldiers.Except(extracted).ToList();

            return extracted;
        }

        public void AddSoldiers(IEnumerable<Soldier> soldiers) =>
            _soldiers.AddRange(soldiers);
    }

    public class SquadManager
    {
        private Squad _squad1;
        private Squad _squad2;

        public void RunTransferProcess()
        {
            InitializeSquads();

            Console.WriteLine("=== До перевода ===");
            PrintSquads();

            TransferSoldiers();

            Console.WriteLine("\n=== После перевода ===");
            PrintSquads();
        }

        private void InitializeSquads()
        {
            _squad1 = new Squad(new List<Soldier>
            {
                new Soldier("Иванов", "АК-47"),
                new Soldier("Борисов", "ПМ"),
                new Soldier("Петров", "СВД"),
                new Soldier("Белов", "АК-74"),
                new Soldier("Сидоров", "РПК"),
                new Soldier("Баранов", "ПКМ"),
                new Soldier("Богданов", "АКС-74У")
            });

            _squad2 = new Squad(new List<Soldier>
            {
                new Soldier("Кузнецов", "АК-47"),
                new Soldier("Васильев", "ПМ"),
                new Soldier("Николаев", "РПГ-7")
            });
        }

        private void TransferSoldiers()
        {
            const string transferLetter = "Б";
            var soldiersToTransfer = _squad1.ExtractSoldiers(
                soldier => soldier.LastName.StartsWith(transferLetter, StringComparison.OrdinalIgnoreCase));

            _squad2.AddSoldiers(soldiersToTransfer);
        }

        private void PrintSquads()
        {
            Console.WriteLine("\nОтряд 1 (" + _squad1.Count + " человек):");

            _squad1.GetSoldiersOrdered().ToList().ForEach(Console.WriteLine);

            Console.WriteLine("\nОтряд 2 (" + _squad2.Count + " человек):");

            _squad2.GetSoldiersOrdered().ToList().ForEach(Console.WriteLine);
        }
    }
}
